<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <title>Administración de Cursos</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body>

    <main class="container mt-1">
        
        <section class="border rounded shadow-sm">
            <h2 class="m-3 text-center">Nuevo Curso</h2>

            <form class="m-3" th:action="@{/CursosAdmin/create}" th:object="${curso}" method="post">
                <div class="row g-3">
                    <div class="col-12 col-md-4">
                        <label class="form-label" for="titulo">Título</label>
                        <input id="titulo" th:field="*{titulo}" class="form-control" required>
                    </div>

                    <div class="col-12 col-md-4">
                        <label class="form-label" for="descripcion">Descripción</label>
                        <input id="descripcion" th:field="*{descripcion}" class="form-control" required>
                    </div>

                    <div class="col-12 col-md-2">
                        <label class="form-label" for="instructorId">ID Instructor</label>
                        <input id="instructorId" th:field="*{instructorId}" type="number" class="form-control" required>
                    </div>

                    <div class="col-12 col-md-2">
                        <label class="form-label" for="estado">Estado</label>
                        <select id="estado" th:field="*{estado}" class="form-control" required>
                            <option value="EN_REVISION">Pendiente</option>
                            <option value="APROBADO">Aprobado</option>
                            <option value="RECHAZADO">Rechazado</option>
                        </select>
                    </div>
                </div>

                <div class="text-center">
                    <button type="submit" class="btn btn-success m-3 px-4">Guardar Curso</button>
                </div>
            </form>
        </section>

        <!-- Sección de administración de cursos -->
        <section class="border rounded shadow-sm mt-3 mb-3 px-3">
            <h2 class="m-3 text-center">Administración de Cursos</h2>

            <div class="table-responsive-sm">
                <form id="cursos-form" th:action="@{/CursosAdmin/update}" method="POST">
                    <table id="cursos-table"
                        class="table table-sm table-bordered table align-middle text-center table-striped table-hover w-100">
                        <thead class="table-light">
                            <tr>
                                <th>Título</th>
                                <th>Descripción</th>
                                <th>ID Instructor</th>
                                <th>Estado</th>
                                <!-- <th>Eliminar</th> -->
                            </tr>
                        </thead>
                        <tbody>
                            <tr th:each="curso, iterStat : ${cursos}">
                                <td>
                                    <input type="hidden" th:name="cursos[__${iterStat.index}__].id"
                                           th:value="${curso.id}" />
                                    <input type="text" class="form-control form-control-sm"
                                           th:name="cursos[__${iterStat.index}__].titulo"
                                           th:value="${curso.titulo}">
                                </td>
                                <td>
                                    <input type="text" class="form-control form-control-sm"
                                           th:name="cursos[__${iterStat.index}__].descripcion"
                                           th:value="${curso.descripcion}">
                                </td>
                                <td>
                                    <input type="number" class="form-control form-control-sm"
                                           th:name="cursos[__${iterStat.index}__].instructorId"
                                           th:value="${curso.instructorId}">
                                </td>
                                <td>
                                    <select class="form-control form-control-sm"
                                            th:name="cursos[__${iterStat.index}__].estado">
                                        <option value="EN_REVISION"
                                                th:selected="${curso.estado == 'EN_REVISION'}">Pendiente</option>
                                        <option value="APROBADO"
                                                th:selected="${curso.estado == 'APROBADO'}">Aprobado</option>
                                        <option value="RECHAZADO"
                                                th:selected="${curso.estado == 'RECHAZADO'}">Rechazado</option>
                                    </select>
                                </td>
                                <!-- <td>
                                    <form th:id="'delete-form-' + ${curso.id}"
                                          th:action="@{'/admin/curso/delete/' + ${curso.id}}"
                                          method="POST">
                                    </form>
                                    <button type="submit"
                                            th:form="'delete-form-' + ${curso.id}"
                                            class="btn btn-outline-danger btn-sm"
                                            onclick="return confirm('¿Eliminar este curso?');">🗑</button>
                                </td> -->
                            </tr>
                        </tbody>
                    </table>

                    <!-- <div class="text-center">
                        <button type="submit" class="btn btn-success mb-3 px-4">💾 Guardar cambios</button>
                    </div> -->
                </form>
            </div>
        </section>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="/scripts/tables.js"></script>
    <script src="/scripts/alerts.js"></script>
</body>

</html>
